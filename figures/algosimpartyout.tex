
\begin{bbox}[title={Algorithm $\msf{SimPartyOutput}(m, P_i')$}]

	\begin{renumerate}
		\item If $P_i'$ is dishonest:
			
			\quad Send $(m, P_i') \rightarrow \mathcal{Z}$

		\item Else if no dealer input yet:

			\quad \Assert $\mathcal{D}$ is dishonest

			\quad $OK \leftarrow \{ Send (input, m) \rightarrow \mathcal{D} \}$

			\quad $leaks \leftarrow \{ Send (\msf{getleaks}) \rightarrow \mathcal{W}_{sync}$
		
			\quad {\bf For} $leak \in leaks$:
				\begin{renumerate}
					\item {\bf Match} $leak$:
						\begin{renumerate}
							\item {\bf case} (schedule, $nd$, $idx$) from $\F_{bcast}$:

								\quad Let $leak$ be the $i^{th}$ schedule leak received.

								\quad $\msf{pidToIdx}[i] = (rnd, idx)$

								\quad $\msf{ideadelay} \pluseq 1$
						\end{renumerate}
				\end{renumerate}
		\item $rnd,idx \leftarrow \text{ pop } \msf{pidToIdx}[P_i']$

		\item Update $\msf{pidToIdx}$ indices like $\mathcal{W}_{sync}$

		\item $\Send (\msf{exec}, rnd, idx) \rightarrow \mathcal{W}_{sync}$
		
	\end{renumerate}

\end{bbox}
