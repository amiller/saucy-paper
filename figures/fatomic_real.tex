\begin{bbox}[title={$\mathcal{F}_\msf{Atomic}$}]

Initialize: $\msf{BC} \leftarrow \emptyset$

\OnInput \inmsg{tx} from $P_i$:
	\begin{enumerate}
		\item \Leak (\msf{tx}, \Partyi)

		\item \Send (\Schedule, \msf{Broadcast}, \msf{tx}) $\rightarrow \Wasync$

	\end{enumerate}
   
{\bf \color{Black} Code} \tsc{Broadcast} $(msg)$:

	\begin{enumerate}
		\item Append $msg$ to \msf{BC}, $\msf{pos} \leftarrow |\msf{BC}|$

		\item For each $P_j$:

			\quad \Leak (\msf{pos}, $P_j$)

			\quad \Send (\Schedule, \msf{Send}, (\msf{BC}[1:\msf{pos}], $P_j$)) $\rightarrow \Wasync$
		
    \end{enumerate}

{\bf \color{Black} Code} \tsc{Send} $(msg, P_i)$:
\begin{enumerate}
	\item \Send $msg \rightarrow P_i$ 
\end{enumerate}


\end{bbox}
