\begin{bbox}[title={\textbf{Wrapper} $\Wasync$} ] 

Intialize $\msf{runqueue} := \emptyset, \msf{leakbuffer} := \emptyset, delay := 0$

\vspace{2mm} \hrule \vspace{2mm}

\OnInput \inmsg{\textsc{Schedule}}{f}{args} from $\mathcal{F}/P_i$:
	\begin{enumerate}
		\item Append ($\mathcal{F}/P_i, f, args$) to \msf{runqueue}
		\item Append ($\mathcal{F}/P_i, f, args$) to \msf{leakbuffer}
		\item $delay = delay + 1$
		\item Send $OK \rightarrow \mathcal{F}/P_i$
	\end{enumerate}


\OnInput

\OnInput \inmsg{\textsc{Advance}} from $\mathcal{Z}$:
	\begin{enumerate}
		\item If $delay > 0$:

			\quad  $delay = delay - 1$

			\quad  \Send \textsc{Advance} $\rightarrow \mathcal{A}$
		\item Else:
			
			\quad $(\mathcal{F}, f, args) \leftarrow$ pop $\msf{runqueue}$

			\quad Send $(\Exec, f, args) \rightarrow \mathcal{F}$
	\end{enumerate}
\end{bbox}
